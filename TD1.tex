\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{tpl} %tdtp
\usepackage{aeguill}
\usepackage{epsfig,graphicx}
\usepackage{subfigure}
\usepackage{eurosym}
\usepackage{enumitem}
\usepackage{hyperref}
\makeatletter


\renewcommand\thesection{Exercice \arabic{section} : }


\sorte{TD}
\siglemat{Python et Open data}
\formation{L1 MIASHS}
\titre{TD1 : API de calcul de trajets}
\begin{document}

\section*{Travail à préparer avant la séance}
\begin{itemize}
    \item Aller sur le site de graphHopper : https://graphhopper.com/
    \item Se créer un compte (sign up). Vous pouvez indiquer "Université Rennes 2" pour le champ Company.
    \item Vous allez recevoir un mail de confirmation : cliquer sur le lien reçu par mail pour valider votre compte.
    \item Se connecter avec vos identifiants sur GraphHopper
    \item Aller dans l'onglet API key
    \item Créer une clé avec "Add API key". Dans description, vous pouvez indiquer Python L2
    \item Sauvegarder la chaine textuelle de la clé, de type e7c81e8f-fcxxxx-xxxxx-xxxxx.
\end{itemize}

\section*{Préambule}
\begin{enumerate}
    \item Créer sur votre disque un dossier PythonOpenData dans lequel vous réaliserez l'ensemble des travaux. 
    \item Télécharger sur Cursus l'archive contenant les données sources du TD1.
    \item Décompresser cette archive sur votre disque. 
    Les fichiers doivent se trouver dans PythonOpenData/TD1.
    \item Lancer l'éditeur Visual Studio Code.
    \item Dans Visual Studio Code, ouvrir le dossier PythonOpenData/TD1. 
\end{enumerate}

\section*{Installation du module graphh}

Par défaut, le module graphh n’est pas installé sur votre ordinateur ni sur les machines de l’université. Pour pouvoir l’utiliser, il va donc falloir commencer par l’installer. 

Avec Visual Studio Code : 
\begin{itemize}
    \item Ouvrir une fenêtre de terminal par le menu "Affichage - Terminal".
    \item Taper la commande \verb+pip install graphh+.
\end{itemize}

Note : cette action est à effectuer une fois pour toutes sur votre machine personnelle, si vous l’utilisez en TD, ou à chaque début de TD sur une machine de l’université si vous travaillez sur un poste de l’université.

\section{Préparation de la clé d'API}
\begin{enumerate}
    \item Dans le fichier credentials.json, insérer votre clé d'API préalablement créée.
    \item Dans le fichier td1.py, la fonction fournie \verb+acces_cle_api+ permet de lire la clé API dans le fichier credentials.json. 
    Utiliser cette fonction pour afficher votre clé d'API.
\end{enumerate}
        
\section{Prise en main de GraphHopper}
\begin{enumerate}
    \item Créer un client GraphHopper en utilisant votre clé d'API.
    \item Obtenir les coordonnées GPS de "Rennes Beaulieu" ainsi que de "Rennes Villejean".
    \item Afficher la distance par la route pour relier les deux campus, de Beaulieu vers Villejean, puis dans le sens inverse.
    \item Afficher la durée pour aller de Villejean à Beaulieu en voiture puis en vélo. 
\end{enumerate}

\section{Définition de fonctions}
\begin{enumerate}
    \item Créer une fonction \verb+distance_lieux+ qui prend en entrée un client GraphHopper, et deux chaines de caractères représentant des lieux, et qui renvoie la distance, en kilomètres, entre ces deux lieux.
    \item Tester cette fonction pour calculer la distance de Rennes à Brest.
    \item Créer une fonction \verb+duree_lieux+ qui prend en entrée un client GraphHopper, et deux chaines de caractères représentant des lieux, et qui renvoie la duree du trajet en voiture, en minutes, entre ces deux lieux.
    \item Tester cette fonction pour calculer la duree du trajet de Rennes à Brest.
\end{enumerate}


\section{Voyage à étapes}
On définit un voyage comme une liste de lieux (chaines de caractère). Chaque lieu de la liste est une étape du voyage.

Pour toutes les fonctions demandées, penser à chaque fois à utiliser d'autres fonctions existantes !

\begin{enumerate}
    \item Une variable \verb+voyage1+ est définie dans le fichier source. Définir un second voyage de votre choix.
    \item Définir une fonction \verb+distances_etapes+ qui prend en entrée un voyage, un client GraphHopper, et renvoie la liste des distances de chaque étape. Tester sur les deux voyages.
    \item Définir une fonction \verb+distance_totale+ qui prend en entrée un voyage et un client GraphHopper, et renvoie la distance totale du trajet en passant par chacune des étapes.
\end{enumerate}


\end{document}
