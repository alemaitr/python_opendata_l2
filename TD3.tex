\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{tpl} %tdtp
\usepackage{aeguill}
\usepackage{epsfig,graphicx}
\usepackage{subfigure}
\usepackage{eurosym}
\usepackage{enumitem}
\usepackage{hyperref}
\makeatletter


\renewcommand\thesection{Exercice \arabic{section} : }


\sorte{TD}
\siglemat{Python et Open data}
\formation{L2 MIASHS}
\titre{TD3 : Compteurs de passages de vélos Rennes Métropole}
\begin{document}

%Ce sujet traite des fichiers JavaScript Object Notation (JSON).
%Ce format permet de stocker des données structurées, par exemple avec une organisation hiérarchique.

\section*{Préambule}
\begin{enumerate}
    \item Dans votre dossier PythonOpenData, créez un sous-répertoire TD3 dans lequel vous réaliserez l'ensemble des travaux.
    \item Lancer l'éditeur Visual Studio Code depuis Anaconda Navigator.
    \item Dans Visual Studio Code, ouvrir le dossier PythonOpenData/TD3. 
\end{enumerate}

Ce TD se concentre sur un jeu de données de comptage du nombre de passages de vélos à Rennes au niveau d'un certain nombres de bornes de comptage. 
Ce jeu de données est issu de la plateforme Open Data de Rennes Métropole, et l'on s'est restreint ici au mois d'avril 2024. Les données sont fournies au format JSON (JavaScript Object Notation).

\section{Chargement des données}

\begin{enumerate}
    \item Sur CURSUS, télécharger le jeu de données \verb+eco-counter-data_clean.json+ et l'enregistrer dans le dossier PythonOpenData/TD3.
    \item Visualiser avec Visual Studio Code le contenu du fichier JSON.
    \item Quels sont les attributs (clés de dictionnaires) de ce jeu de données ? Que contient l'attribut \verb+date+ ?
    \item Noter quelques uns des noms de compteurs (attribut \verb+name+).
\end{enumerate}

Dans la suite de ce sujet, on nomme \og enregistrement\fg ~chaque dictionnaire issu du fichier JSON.
Notons que chaque enregistrement contient une date. Ainsi, une date codée sous la forme :
\begin{verbatim}
    "date": {
        "year": 2024,
        "month": 4,
        "day": 2,
        "hour": 10
    }
\end{verbatim}

\noindent
correspond au créneau \verb+10h-11h+ le 2 avril 2024 et l'enregistrement correspondant indique donc le nombre de passages de vélos au niveau de la borne de comptage considérée sur ce créneau.

\section{Extraction d'informations élémentaires}

Les questions suivantes nécessitent de manipuler les données depuis Python et le code produit devra être inclus dans le fichier \verb+td3.py+.

\begin{enumerate}
\item Charger le contenu du fichier \verb+eco-counter-data_clean.json+ dans une variable \verb+donnees+. \verb+donnees+ doit être une liste des enregistrements, chaque enregistrement étant stocké dans un dictionnaire.

\item Écrire une fonction qui prend en entree la liste des enregistrements et retourne une liste sans doublon de tous les noms de compteurs (attribut \verb+name+) contenus dans le jeu de données.

\item Écrire une fonction qui prend en entrée le jeu de données et la liste des noms de compteur et affiche, pour chaque compteur (\emph{i.e.} pour chaque valeur différente de l'attribut \verb+name+), le nombre total de passages de vélos.

\item Écrire une fonction qui prend en entrée le jeu de données et la liste des noms de compteur et affiche, pour chaque compteur, le nombre total de passages de vélos en date du 9 avril 2024.

\item Écrire une fonction qui prend en entrée le jeu de données et retourne, dans une structure adaptée, le nombre de passages de vélo pour chaque heure de la journée (0h-1h, 1h-2h, ..., 23h-24h), tous compteurs et tous jours confondus.

\item Afficher l'heure du jour à laquelle on compte le plus grand nombre de passages de vélos, tous compteurs et tous jours confondus.
\end{enumerate}

\section{Export au format JSON}

Dans cette partie, il va s'agir d'enregistrer un export du contenu du fichier \verb+eco-counter-data_clean.json+ avec des données corrigées.

\begin{enumerate}
    \item Écrire une fonction qui prend en entrée le jeu de données précédent et retourne une nouvelle version de ce jeu de données dans lequel l'attribut \verb+gps_coords+ a été remplacé par deux nouveaux attributs \verb+latitude+ et \verb+longitude+ (qui correspondent respectivement au premier et second éléments de la liste \verb+gps_coords+).
    
    \item Écrire une fonction qui prend en entrée le jeu de données précédent et retourne une nouvelle version de ce jeu de données dans lequel l'attribut \verb+date+ est représenté par une chaîne de caractères de la forme \verb+20/03/2007 17h-18h+.
    
    \item En utilisant les deux fonctions précédentes, exporter cette nouvelle version du jeu de données dans un fichier nommé \verb+eco-counter-data_out.json+. Pour une meilleure lisibilité, vous ferez en sorte de fixer l'indentation du fichier obtenu à 2 caractères.
\end{enumerate}

\end{document}
